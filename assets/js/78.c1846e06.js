(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{429:function(s,n,e){"use strict";e.r(n);var t=e(25),a=Object(t.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"前端代码规范最佳实践"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前端代码规范最佳实践"}},[s._v("#")]),s._v(" 前端代码规范最佳实践")]),s._v(" "),e("p",[s._v("本文参考于："),e("a",{attrs:{href:"https://www.jianshu.com/p/8312704c6be7",target:"_blank",rel:"noopener noreferrer"}},[s._v("前端代码规范最佳实践"),e("OutboundLink")],1),e("br"),s._v("\neslint+prettier+editorconfig+lint-staged")]),s._v(" "),e("h2",{attrs:{id:"前言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),e("p",[s._v("项目开发过程中，用到各种代码规范性工具。")]),s._v(" "),e("p",[s._v("时不时就会出现，多种工具重复作用，相互之间有冲突的情况。")]),s._v(" "),e("p",[s._v("比如：按照 prettier 的规则格式化的代码，不符合 eslint 的规定。于是 eslint 报错。")]),s._v(" "),e("h2",{attrs:{id:"eslint"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eslint"}},[s._v("#")]),s._v(" eslint")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://eslint.bootcss.com/docs/user-guide/getting-started",target:"_blank",rel:"noopener noreferrer"}},[s._v("eslint官网文档"),e("OutboundLink")],1),e("br"),s._v("\n通过配置 .eslintrc.* 制定团队代码规范。")]),s._v(" "),e("p",[s._v("在代码编写的过程中，出现不符合规范的代码，进行红线提示。帮助开发者及时更正不符合规范的代码。")]),s._v(" "),e("p",[s._v("同时，提供命令行检查规范及 auto-fix 能力。")]),s._v(" "),e("p",[e("strong",[s._v("【具体】")]),s._v("\n检查 main.js 文件的代码规范：")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("npx eslint main.js\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("自动修复 main.js 部分规范问题（通常如：缺少/多余分号，缩进格式等）：")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("npx eslint main.js --fix\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("【注意】")])]),s._v(" "),e("p",[s._v("eslint 的 auto-fix，能够修复的规范问题比较有限。")]),s._v(" "),e("p",[s._v("通常，需要较大变动才能修复的规范问题，eslint 无法自动修复。如：单行不能超过 80 个字符。")]),s._v(" "),e("h2",{attrs:{id:"prettier"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prettier"}},[s._v("#")]),s._v(" prettier")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://prettier.io/docs/en/install.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("prettier官网文档"),e("OutboundLink")],1),e("br"),s._v("\n根据规范，自动格式化代码。具有比 eslint auto-fix 更加强大的代码规范性修复能力。")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("npx prettier main.js --write\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("prettier 会根据 .eslintrc.* 的约定，修复 main.js 的规范性问题。包括较大变动才能修复的规范问题。如：单行不能超过 80 个字符。")]),s._v(" "),e("h2",{attrs:{id:"editorconfig"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#editorconfig"}},[s._v("#")]),s._v(" editorconfig")]),s._v(" "),e("p",[s._v("编辑器配置。用于覆盖编辑器默认配置，以确保不同编辑器之间，代码格式的统一。")]),s._v(" "),e("p",[s._v("比如，使用 editorconfig，规定开发过程中，点击 tab 按钮，是以 tab 格式进行缩进，还是以 space 格式进行缩进。")]),s._v(" "),e("p",[s._v("如果没有约定，不同的编辑器，或者相同编辑器、不同开发者的配置存在差异，可能出现，有的人是 tab 缩进、有的人是 space 缩进的情况，造成代码风格的差异。")]),s._v(" "),e("p",[e("strong",[s._v("【注】")])]),s._v(" "),e("p",[s._v("vscode 这类编辑器，需要自行安装 editorconfig 插件。")]),s._v(" "),e("h2",{attrs:{id:"进行配置-js文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#进行配置-js文件"}},[s._v("#")]),s._v(" 进行配置（js文件）")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("安装 eslint + prettier")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yarn add eslint prettier -D\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("安装 eslint-config-prettier")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yarn add eslint-config-prettier -D\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("【作用】")])]),s._v(" "),e("p",[s._v("让所有可能会与 prettier 规则存在冲突的 eslint rule，失效，并使用 prettier 的规则进行代码检查。")]),s._v(" "),e("p",[s._v("相当于，用 prettier 的规则，覆盖掉 eslint:recommended 的部分规则。")]),s._v(" "),e("p",[s._v("后面 prettier 格式化，也会根据这个规则来。因此，不会再有冲突。")]),s._v(" "),e("p",[e("strong",[s._v("【使用】")])]),s._v(" "),e("p",[s._v(".eslintrc.js")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{\n\n    "extends": ["eslint:recommended", "prettier"]\n\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("安装 eslint-plugin-prettier")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yarn add eslint-plugin-prettier -D\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("【作用】")])]),s._v(" "),e("p",[s._v("将 prettier 的能力集成到 eslint 中。按照 prettier 的规则检查代码规范性，并进行修复。")]),s._v(" "),e("p",[e("strong",[s._v("【使用】")])]),s._v(" "),e("p",[s._v(".eslintrc.js")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{\n\n    "rules":{\n\n        "prettier/prettier":"error" // 不符合 prettier 规则的代码，要进行错误提示（红线）\n\n    },\n\n    "plugins": ["prettier"]\n\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("p",[s._v("或")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{\n\n    "extends": ["eslint:recommended","plugin:prettier/recommended"]\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[e("strong",[s._v("【看一下效果】")])]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("npx eslint --fix main.js\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("至此，eslint 会拥有和 prettier 一样的修复能力。")]),s._v(" "),e("p",[s._v("像 prettier 一样，格式化所有不符合规范的代码。")])])]),s._v(" "),e("h2",{attrs:{id:"使用编辑器-自动格式化代码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用编辑器-自动格式化代码"}},[s._v("#")]),s._v(" 使用编辑器，自动格式化代码")]),s._v(" "),e("p",[e("strong",[s._v("（1）使用自己编辑器的快捷键，格式化代码")])]),s._v(" "),e("p",[s._v("以 vscode 为例：shift + option + f")]),s._v(" "),e("p",[s._v("默认格式化规则选择 prettier，即可完成代码格式化。")]),s._v(" "),e("p",[e("strong",[s._v("（2）保存代码，自动格式化")])]),s._v(" "),e("p",[s._v("同样以 vscode 为例，打开你的 settings.json，添加下面这句话：")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('"editor.formatOnSave": true\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("【注】")])]),s._v(" "),e("p",[s._v("至此，js、json、less等文件，均可实现自动格式化。")]),s._v(" "),e("p",[s._v("文件格式化规则，遵从我们在 .eslintrc.js 里的配置。也就是，使用我们的 prettier 插件默认规则去格式化。")]),s._v(" "),e("p",[e("strong",[s._v("【附】")])]),s._v(" "),e("p",[s._v("如果你使用的是 webstorm，或许可以参考这个 "),e("a",{attrs:{href:"https://www.jianshu.com/p/2f3cad152192",target:"_blank",rel:"noopener noreferrer"}},[s._v("webstorm配置"),e("OutboundLink")],1)]),s._v(" "),e("h2",{attrs:{id:"规则定制化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#规则定制化"}},[s._v("#")]),s._v(" 规则定制化")]),s._v(" "),e("p",[s._v("保存任意 js 文件，观察当前规则是否符合期望。如果不符合，根目录下创建 .prettierrc，进行定制化配置。")]),s._v(" "),e("p",[s._v("如 .prettierrc 如下：")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{\n    "singleQuote": true\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("再次保存代码，prettier 将会把 js 文件中的双引号，全部格式化为单引号。")]),s._v(" "),e("p",[s._v("至此，对 js 文件的规范定义与自动格式化配置，全部完成。")]),s._v(" "),e("p",[e("strong",[s._v("【注】")])]),s._v(" "),e("p",[s._v("这里的 .prettierrc，具有格式化规则的最高优先级。")]),s._v(" "),e("h2",{attrs:{id:"让-eslint-认识-js-以外的更多语法【以-typescript-为例】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#让-eslint-认识-js-以外的更多语法【以-typescript-为例】"}},[s._v("#")]),s._v(" 让 eslint 认识 js 以外的更多语法【以 typescript 为例】")]),s._v(" "),e("ol",[e("li",[e("p",[e("strong",[s._v("安装")]),e("br"),s._v("\n（1）使用 ts，自然要安装 typescript")]),s._v(" "),e("p",[s._v("（2）为了让 eslint 认识 ts 语法，要安装相应的 parser")]),s._v(" "),e("p",[s._v("（3）为了指定 ts 代码的规范，要安装相应的 plugin")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    yarn add typescript @typescript-eslint/parser @typescript-eslint/eslint-plugin -D\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("配置")])]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{\n\n    "parser":"@typescript-eslint/parser",\n\n    "extends":["plugin:@typescript-eslint/recommended", "eslint:recommended", "prettier"],\n\n    "env":{\n\n        "es6":true,\n\n        "node":true\n\n    },\n\n    "rules":{\n\n        "prettier/prettier":"error"\n\n    },\n\n    "plugins": ["prettier"]\n\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br")])]),e("p",[e("strong",[s._v("【注】extends 的含义")]),s._v("\n告诉 eslint，根据指定的规范，去检查指定类型的文件。")]),s._v(" "),e("p",[e("strong",[s._v("如上例：")])]),s._v(" "),e("p",[s._v("根据 @typescript-eslint/recommended 规范，检查 ts 代码。")]),s._v(" "),e("p",[s._v("根据 eslint:recommended + prettier 规范，去检查 js 代码。")]),s._v(" "),e("p",[s._v("当某一类型的文件，被制定了不止1个规范，存在某些规范冲突时，后面的会覆盖掉前面的。")]),s._v(" "),e("p",[s._v("在本例中，prettier 制定的规范，会覆盖掉 eslint:recommended 的某些规范。")]),s._v(" "),e("p",[s._v("eslint 会按照覆盖后的规则，去检查 js 文件。")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("使用")])]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("   npx eslint --fix main.ts\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("【如果能够正常格式化】")])]),s._v(" "),e("p",[s._v("done。")]),s._v(" "),e("p",[e("strong",[s._v("【如果出现问题】")])]),s._v(" "),e("p",[s._v("这里，eslint 会使用 prettier 插件，根据 prettier 的规则格式化代码。")]),s._v(" "),e("p",[s._v("但同时，eslint 会根据 @typescript-eslint/recommended 的规则，检查代码规范性。")]),s._v(" "),e("p",[s._v("当 @typescript-eslint/recommended 的规则和 prettier 的规则出现不一致，就会造成，格式化后的代码，报 eslint 错误的问题。")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("解决冲突（如果存在冲突）")]),s._v("\n使用相应的 prettier 插件，消除冲突。")]),s._v(" "),e("p",[s._v("也就是说，prettier 的规则和 @typescript-eslint/recommended 存在冲突，那就使用 prettier/@typescript-eslint 插件。")]),s._v(" "),e("p",[s._v("和前面，使用 eslint-config-prettier 消除 eslint:recommended 与 prettier 的规则冲突，同理。")]),s._v(" "),e("p",[s._v("具体可以使用那些插件，查阅：https://github.com/prettier/eslint-config-prettier")]),s._v(" "),e("p",[s._v("它们全部由 eslint-config-prettier 这个库提供。")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{\n\n   "parser":"@typescript-eslint/parser",\n\n    "extends":[\n\n        "plugin:@typescript-eslint/recommended", \n\n        "eslint:recommended", \n\n        "prettier", \n\n        "prettier/@typescript-eslint"\n\n    ],\n\n    "env":{\n\n        "es6":true,\n\n        "node":true\n\n    },\n\n    "rules":{\n\n        "prettier/prettier":"error"\n\n    },\n\n    "plugins": ["prettier"]\n\n}\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br")])]),e("p",[e("strong",[s._v("【注意】")])]),s._v(" "),e("p",[s._v("这里，不要通过手动写 rules，去消除出现的冲突。")]),s._v(" "),e("p",[s._v("因为，已经发现的冲突，可能只是部分冲突，手写 rule 不能完整解决冲突问题，会存在遗漏。")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("自定义规则")]),e("br"),s._v("\n当 prettier 插件的默认规则，与团队习惯不符合时，进行规则自定义。")]),s._v(" "),e("p",[s._v("（1）校验规则定义（.eslintrc.js）")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\n{\n\n   "parser":"@typescript-eslint/parser",\n\n    "extends":[\n\n        "plugin:@typescript-eslint/recommended", \n\n        "eslint:recommended", \n\n        "prettier", \n\n        "prettier/@typescript-eslint"\n\n    ],\n\n    "env":{\n\n        "es6":true,\n\n        "node":true\n\n    },\n\n    "rules":{\n\n        "prettier/prettier":"error",\n\n        // 比如，自定义缩进约束为4格（注意：这个规则会对所有文件生效，不只是ts）      \n\n        "@typescript-eslint/indent": ["error", 4]     \n\n    },\n\n    "plugins": ["prettier"]\n\n}\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br")])]),e("p",[s._v("（2）格式化规则定义（.prettierrc）")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{\n\n    "tabWidth": 4  // 与 eslint 的自定义规则保持一致\n\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])])]),s._v(" "),e("h2",{attrs:{id:"prettier-和-editorconfig"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prettier-和-editorconfig"}},[s._v("#")]),s._v(" Prettier 和 EditorConfig")]),s._v(" "),e("p",[s._v("有些规则，editorconfig 和 .prettierrc 同时可以定义。")]),s._v(" "),e("p",[s._v("因此，我们要避免冗余、重复的定义。")]),s._v(" "),e("p",[s._v("这些规则如下：")]),s._v(" "),e("p",[s._v("end_of_line")]),s._v(" "),e("p",[s._v("indent_style")]),s._v(" "),e("p",[s._v("indent_size/tab_width")]),s._v(" "),e("p",[s._v("max_line_length")]),s._v(" "),e("p",[s._v("我们将这些规则的定义，均放在 .editorconfig 中。")]),s._v(" "),e("p",[s._v("配置好 .editorconfig 后，保存代码，即使没有配置 .prettierrc，prettier 也会按照 .editorconfig 的定义来格式化代码。")]),s._v(" "),e("h2",{attrs:{id:"规范检查增强-husky-lint-staged"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#规范检查增强-husky-lint-staged"}},[s._v("#")]),s._v(" 规范检查增强（husky + lint-staged）")]),s._v(" "),e("p",[s._v("在 git commit 之前，先强制执行prettier格式化（防止某些成员开发期间不开启编辑器格式化）、再检查代码规范，如果检查不通过、阻止提交。")]),s._v(" "),e("ol",[e("li",[s._v("新建 .eslintignore + .prettierignore\n.eslintignore、.prettierignore，参考如下：")])]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(".DS_Store\n\nnode_modules\n\ndist\n\n\n\n.gitignore\n\n.eslintignore\n\n.prettierignore\n\nLICENSE\n\nREADME.md\n\nyarn.lock\n\n# local env files\n\n.env.local\n\n.env.*.local\n\n# Log files\n\nnpm-debug.log*\n\nyarn-debug.log*\n\nyarn-error.log*\n\n# Editor directories and files\n\n.idea\n\n.vscode\n\n*.suo\n\n*.ntvs*\n\n*.njsproj\n\n*.sln\n\n*.sw?\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br")])]),e("p",[s._v("2.安装")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yarn add husky lint-staged -D\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("3.使用\npackage.json添加：")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\n"scripts": {\n\n    "lint": "eslint .",\n\n    "prettier": "prettier --write ."\n\n},\n\n"husky": {\n\n    "hooks": {\n\n      "pre-commit": "lint-staged"\n\n    }\n\n  },\n\n  "lint-staged": {\n\n    "*": [\n\n        "npm run prettier", \n\n        "npm run lint",\n\n        "git add ."\n\n    ]\n\n  }\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br")])]),e("p",[s._v("git commit 之前，会自动使用 prettier 格式化 ignore 之外的代码。格式化后，自动检查所有文件，是否全部符合 eslint 规范。")]),s._v(" "),e("p",[s._v("存在不符合规范的代码，git commit 将被终止。")]),s._v(" "),e("p",[e("strong",[s._v("【注】")])]),s._v(" "),e("p",[s._v("因为 prettier 只是会帮我们格式化代码，并不能够修复所有 eslint 错误，比如定义未使用的变量，prettier 不会自动帮我们删除，要手动删除。")]),s._v(" "),e("p",[s._v("因此，prettier 后再 eslint，是有必要的。")])])}),[],!1,null,null,null);n.default=a.exports}}]);